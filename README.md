# Описание системы

Данная система предназначена для полуавтоматического развертывания серверов, выполняющих роли Frontend и Backend, и содержащих комплекс соответствующих служб и конфигураций. В данной статье описывается вариант установки Frontend и Backend на единственный хост, выолняющий обе роли, однако, система также подойдет и для варианта развертывания вышеуказанных ролей на отдельных хостах, так как для развертывания используется подключение к хостам по протоколу SSH (в данном варианте подключение для развертывания будет осуществляться с того же хоста, на котором будут развернуты Frontend и Backend, поэтому IP-адресами Frontend и Backend будет являться адрес localhost - 127.0.0.1). В качестве менеджера развертывания системы используется Ansible. В качестве платформы для тестирования системы использовался контейнер LXC "almalinux-8_amd64", развернутый в системе виртуализации Proxmox 7.3_1.


# Описание файлов конфигураций, скриптов и т.д.


## Ansible

**ansible.cfg** - конфигурация Ansible в пределах данного проекта

**inventory** - файл, содержащию информацию об управляемых хостах, в том числе адреса хостов и настройки для подключения к ним

**frontend_deploy.yml** - сценарий для развертывания Frontend

**backend_*.yml** - сценарии для развертывания/удаления служб Backend

## Frontend

**frontend/backup.sh** - скрипт бэкапирования директорий и файлов, необходимых для восстановления системы
**frontend/http.conf** - конфигурация nginx для редиректа запросов с HTTP на HTTPS
**frontend/monitor.service** - конфигурация службы systemd для мониторинга служб Backend
**frontend/monitor.sh** - скрипт для службы мониторинга
**frontend/nginx.conf** - основная конфигурация Nginx


# Развертывание системы


## Необходимые предварительные настройки и условия

- Физическая или виртуальная машина (или контейнер) с установленной ОС семейства RHEL (Almalinux 8) в свежей минимальной установке для развертывания системы.
- Добавленные A-записи на DNS-сервере для соответствия доменных имен Backend-служб IP-адресу сервера Backend. Клиентская машина должна иметь возможность разрешать используемые доменные имена служб в IP-адреса. Для каждой новой добавленной службы Backend-хоста необходимо добавлять соответствующую запись. Сделать это можно разными способами. Самы простой способ - прописать на клиентской машине IP-адрес основного DNS-сервера.

Пример (DNS-сервер на Mikrotik RouterOS):

```
/ip dns static
add address=192.168.111.140 name=service-a.example.com
add address=192.168.111.140 name=service-b.example.com
```

